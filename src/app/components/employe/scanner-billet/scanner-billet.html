<div class="container mt-4" style="max-width: 700px;">

    <h2 class="text-center mb-4">ðŸ“¸ Scanner un billet</h2>

    <!-- Message d'erreur si permission refusÃ©e -->
    <div *ngIf="!hasPermission && errorMessage" class="alert alert-danger text-center">
        <strong>{{ errorMessage }}</strong>
        <br>
        <button class="btn btn-primary mt-2" (click)="retryCamera()">ðŸ”„ RÃ©essayer la camÃ©ra</button>
    </div>

    <!-- Carte principale -->
    <div class="card shadow-lg p-3">

        <!-- SÃ©lection camÃ©ra -->
        <div class="mb-3">
            <label class="form-label fw-bold">SÃ©lectionnez la camÃ©ra :</label>
            <select id="deviceSelect" [(ngModel)]="currentDevice" class="form-select">
                <option *ngFor="let cam of availableDevices" [ngValue]="cam">
                    {{ cam.label }}
                </option>
            </select>
        </div>

        <!-- Boutons Start / Stop -->
        <div class="d-flex justify-content-center gap-2 mb-3">
            <button class="btn btn-success" (click)="startScanner()" [disabled]="scannerStarted">
                â–¶ DÃ©marrer le scanner
            </button>

            <button class="btn btn-danger" (click)="stopScanner()" [disabled]="!scannerStarted">
                â›” ArrÃªter
            </button>
        </div>

        <!-- Zone camÃ©ra -->
        <div *ngIf="scannerStarted" class="camera-wrapper d-flex justify-content-center">

            <div class="camera-frame">
                <zxing-scanner (scanSuccess)="onCodeResult($event)" (camerasFound)="onCamerasFound($event)"
                    (permissionResponse)="onHasPermission($event)" [device]="currentDevice">
                </zxing-scanner>
            </div>

        </div>

    </div>

    <!-- RÃ©sultat scan -->
    <div class="mt-4 text-center">
        <p *ngIf="qrCodeResult" class="alert alert-info">
            <strong>QR Code lu :</strong> {{ qrCodeResult }}
        </p>

        <p *ngIf="message" class="alert alert-success">
            <strong>RÃ©sultat :</strong> {{ message }}
        </p>
    </div>

</div>